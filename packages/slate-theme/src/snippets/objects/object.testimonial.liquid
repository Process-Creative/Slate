{%- comment -%}
  Testimonial
      
  Parameters:
    stars - String, between 1 and 5 indicating review score
    cardTitle - String, Title of the review
    reviewText - String, Content of the review
    image - Image, picture of the reviewer
    name - String, name of the reviewer
    location - String, location of the reviewer
  
  Version:
    2.0.0 - 2021/05/26
{%- endcomment -%}

{%- comment -%} Convert string to integer {%- endcomment -%}
{%- assign stars = rating | plus: 0 -%}
{%- if cardTitle != blank and reviewText != blank  -%}
  <div class="o-testimonial">
    <div class="o-testimonial__body">
      <p class="o-heading--5">
        {{- cardTitle | escape -}}
      </p>

      {{- reviewText -}}
    </div>

    {%- comment -%} Reviewer Info Section {%- endcomment -%}
    {%- if image != blank or name != blank or location != blank -%}
      <div class="o-testimonial__footer">
        {%- if image != blank -%}
          <div class="o-testimonial__footer-left">
            {%- render 'tool.picture' with {
              img: image,
              class: 'o-testimonial__image',
              sizes: '60'
            } -%}
          </div>
        {%- endif -%}
        
        {%- if stars != blank or name != blank or location != blank -%}
          <div>
            {%- comment -%} Render Star Rating {%- endcomment -%}
            {%- liquid
              if stars != blank
                echo '<div class="o-testimonial__stars">'
                for i in (1..5)
                  if i <= stars
                    render 'icon.star'
                  else
                    render 'icon.star-outline'
                  endif
                endfor
                echo '</div>'
              endif
            -%}
          
            {%- comment -%} Reviewer Name and Location {%- endcomment -%}
            {% liquid
              capture footerDetails
                if name != blank
                  echo name | escape
                  if location != blank
                    echo ',&nbsp;'
                  endif
                endif

                if location != blank 
                  echo '<span class="o-testimonial__name-location">'
                  echo location | escape
                  echo '</span>'
                endif
              endcapture

              if footerDetails != blank
                echo '<p class="o-testimonial__name">' | append: footerDetails | append: '</p>'
              endif
            %}
          </div>
        {%- endif -%}
      </div>
    {%- endif -%}
  </div>
{%- endif -%}